<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="js/jquery.flot.min.js"></script>
<script type="text/javascript" src="js/jstat.js"></script>
<script type="text/javascript" src="js/js_nested2.js"></script>
<script type="text/javascript" src="js/plot.js"></script>
<script type="text/javascript" src="js/problem2.js"></script>
<script type="text/javascript">
    function run() {
    	y1 = [1.96, 2.06, 2.03, 2.11, 1.88, 1.88, 2.08, 1.93, 2.03, 2.03, 2.03, 2.08, 2.03, 2.11, 1.93]
    	y2 = [1.83, 1.93, 1.88, 1.85, 1.85, 1.91, 1.91, 1.85, 1.78, 1.91, 1.93, 1.80, 1.80, 1.85, 1.93, 1.85, 1.83, 1.85, 1.91, 1.85, 1.91, 1.85, 1.80, 1.80, 1.85]
        var transform = make_BEST_transform_func(y1, y2)
        var likelihood = make_BEST_likelihood_func(y1, y2)
	integrator = new integrator(4, transform, likelihood, null, 200, 0.5, 10002)
	function progress() {
		var r = integrator.progress()
		if (r != 0) {
			return setTimeout(progress, 0)
		} else {
			console.log("getting results")
			var results = integrator.getResults()
			console.log("calling alert" + results)
			//alert("done! " + results[0] + " +- " + results[1])
			var samples = posterior_samples(results[2], 1000)
			var means = jStat(samples).mean()
			var stdevs = jStat(samples).stdev()
			var text = "<p>evidence ln Z = " + results[0] + " +- " + results[1]
			text = text + "<p>samples (" + samples.length + "): first is " + samples[0]
			text = text + "<p>means: "
			for (var i = 0; i < means.length; i++) {
				text = text + means[i] + " | "
			}
			text = text + "<p>stdevs: "
			for (var i = 0; i < stdevs.length; i++) {
				text = text + stdevs[i] + " | "
			}
			$("#results").html(text)
			$("#results").val(text)
			plot_mcmc_hist("group_diff_hist1", param_chain(samples, 0), false, null)
			plot_mcmc_hist("group_diff_hist2", param_chain(samples, 1), false, null)
			plot_mcmc_hist("group_diff_hist3", param_chain(samples, 2), false, null)
			plot_mcmc_hist("group_diff_hist4", param_chain(samples, 3), false, null)
			console.log("done")
		}
	}
	progress()
	
	//integrator.runInline(function onComplete(logZ, logZerr, points) {
	//	alert("done!")
	//})

    }
    window.onload = run
</script>
</head>
<body>
	<div id="results"></div>
	<div id="group_diff_hist1_wrapper_div" class="sg-11">
		<div class="item_title">Mean 1</div>
		<div id="group_diff_hist1" style="height: 200px; width: 200px;"></div>
		<div class="item_description"></div>
	</div>
	<div id="group_diff_hist2_wrapper_div" class="sg-11">
		<div class="item_title">Mean 2</div>
		<div id="group_diff_hist2" style="height: 200px; width: 200px;"></div>
		<div class="item_description"></div>
	</div>
	<div id="group_diff_hist3_wrapper_div" class="sg-11">
		<div class="item_title">Sigma 1</div>
		<div id="group_diff_hist3" style="height: 200px; width: 200px;"></div>
		<div class="item_description"></div>
	</div>
	<div id="group_diff_hist4_wrapper_div" class="sg-11">
		<div class="item_title">Sigma 2</div>
		<div id="group_diff_hist4" style="height: 200px; width: 200px;"></div>
		<div class="item_description"></div>
	</div>

</body>
</html>
